<link rel="import" href="../../bower_components/iron-selector/iron-selector.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../section-symbol/section-symbol.html">
<link rel="import" href="../tag-link/tag-link.html">
<link rel="import" href="../theme-color/theme-color.html">
<link rel="import" href="../element-dialog/element-dialog.html">
<link rel="import" href="../element-for-in/element-for-in.html">
<dom-module id="page-network">
    <link rel="import" type="css" href="../../styles/main.css">
    <template>
        <style>
        :host {
            background: #fafafa;
        }

        #content {
            overflow: auto;
            -webkit-overflow-scrolling: touch;
            padding: 20px;
        }

        #container {
            background: #fafafa;
        }

        #content h2,
        #content p {
            display: inline-block;
            vertical-align: middle;
        }

        #content p {
            padding-left: 20px;
        }

        paper-material {
            padding: 0 20px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        </style>
        <paper-drawer-panel id="drawerPanel" responsive-width="900px" narrow="{{narrowMode}}" drawer-width="272px" disable-edge-swipe>
            <app-sidebar tag="[[tag]]" sections="{{sections}}" current="[[section.id]]" drawer></app-sidebar>
            <paper-header-panel id="container" mode="[[_getMode(narrowMode)]]" view$="[[_actualView(view)]]" main>
                <div class="paper-header">
                    <paper-icon-button icon="menu" paper-drawer-toggle></paper-icon-button>
                    <h2 class="flex">{{network.name}}</h2>
                    <app-bar class="horizontal layout center end-justified" query="{{q}}"></app-bar>
                    <paper-icon-button icon="icons:sort"></paper-icon-button>
                    <app-user-menu email="[[model.email]]"></app-user-menu>
                </div>
                <div id="content">
                    <paper-card class="info-card" heading="Network Information">
                        <!-- <paper-button on-tap="listInfo">temp network info helper</paper-button> -->
                        <div class="card-content">
                            <div id="networkproperties"></div>
                            <table class="info-table">
                                <tr>
                                    <td>
                                        Name
                                    </td>
                                    <td>
                                        [[network.name]]
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        ID
                                    </td>
                                    <td>
                                        [[network.id]]
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        Type
                                    </td>
                                    <td>
                                        [[network.type]]
                                    </td>
                                </tr>
                                <template is="dom-if" if="[[network.status]]">
                                    <tr>
                                        <td>
                                            Status
                                        </td>
                                        <td>
                                            [[network.status]]
                                        </td>
                                    </tr>
                                </template>
                                <tr>
                                    <td>
                                        Provider
                                    </td>
                                    <td>
                                        [[network.provider]]
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </paper-card>
                    <template is="dom-if" if="[[network.subnets.length]]">
                        <paper-card class="info-card" heading="Subnets ([[network.subnets.length]])">
                            <div class="card-content">
                                <table class="info-table">
                                    <template is="dom-repeat" items="[[network.subnets]]">
                                        <template is="dom-if" if="[[item.name]]">
                                            <tr class="info-table-divider">
                                                <td>
                                                    Name
                                                </td>
                                                <td>
                                                    [[item.name]]
                                                </td>
                                            </tr>
                                        </template>
                                        <template is="dom-if" if="[[item.id]]">
                                            <tr>
                                                <td>
                                                    ID
                                                </td>
                                                <td>
                                                    [[item.id]]
                                                </td>
                                            </tr>
                                        </template>
                                        <template is="dom-if" if="[[item.zone]]">
                                            <tr>
                                                <td>
                                                    Zone
                                                </td>
                                                <td>
                                                    [[item.zone.name]]
                                                </td>
                                            </tr>
                                        </template>
                                        <template is="dom-if" if="[[item.cidr]]">
                                            <tr>
                                                <td>
                                                    Cidr
                                                </td>
                                                <td>
                                                    [[item.cidr]]
                                                </td>
                                            </tr>
                                        </template>
                                        <template is="dom-if" if="[[item.enable_dhcp]]">
                                            <tr>
                                                <td>
                                                    DHCP Enabled
                                                </td>
                                                <td>
                                                    [[item.enable_dhcp]]
                                                </td>
                                            </tr>
                                        </template>
                                        <template is="dom-if" if="[[item.gateway_ip]]">
                                            <tr>
                                                <td>
                                                    Gateway IP
                                                </td>
                                                <td>
                                                    [[item.gateway_ip]]
                                                </td>
                                            </tr>
                                        </template>
                                    </template>
                                </table>
                            </div>
                        </paper-card>
                    </template>
                    <template is="dom-if" if="[[hasExtra]]">
                        <paper-card class="info-card" heading="Full Metadata List">
                            <div class="card-content">
                                <element-for-in content="[[network.extra]]"></element-for-in>
                            </div>
                        </paper-card>
                    </template>
                    <!-- <template is="dom-if" if="[[network.floating_ips]]">
                        <paper-card class="info-card" heading="Floating Ips">
                            <div class="card-content">
                                <element-for-in content="[[network.floating_ips]]"></element-for-in>
                            </div>
                        </paper-card>
                    </template>

                    <template is="dom-if" if="[[network.tags]]">
                        <paper-card class="info-card" heading="Tags">
                            <div class="card-content">
                                <element-for-in content="[[network.tags]]"></element-for-in>
                            </div>
                        </paper-card>
                    </template> -->
                </div>
                <div class="absolute-bottom-right">
                    <paper-menu-button vertical-align="bottom" horizontal-align="right">
                        <paper-fab icon="add" class="dropdown-trigger" alt="bottom align">Actions</paper-fab>
                        <paper-menu class="dropdown-content">
                            <paper-button on-tap="deleteNetwork">Delete Network</paper-button>
                        </paper-menu>
                    </paper-menu-button>
                </div>
            </paper-header-panel>
        </paper-drawer-panel>
        <element-dialog title="[[dialogOptions.title]]" body="[[dialogOptions.body]]"></element-dialog>
    </template>
</dom-module>
<script>
Polymer({
    is: 'page-network',
    enableCustomStyleProperties: true,
    properties: {
        router: Object,
        pageTitle: {
            type: String
        },
        params: {
            type: Object,
            notify: true
        },
        sections: Array,
        section: {
            type: Object,
            notify: true,
            value: {}
        },
        tag: {
            String, value: ""
        },
        network: Object,
        hasExtra: {
            type: Boolean,
            computed: '_computeHasExtra(network)'
        },
        dialogOptions: {
            type: Object,
            value: {
                title: '',
                body: ''
            }
        }
    },
    _computeHasExtra: function(network) {
        return network.type != 'router';
    },
    deleteNetwork: function() {
        var dialog = document.querySelector('#dialog');
        this.set('dialogOptions.title', 'Delete Network');
        this.set('dialogOptions.body', 'Are you sure you want to delete network "' + this.network.name + '"?');
        dialog.open();
    },
    _getMode: function(narrow) {
        return narrow ? 'waterfall' : 'scroll';
    },
});
</script>
